module integ_3D
contains
    
subroutine expfun_beam(eta)
    use var_inputdata
    use var_analysis
    use read_input_data
    
    implicit none
    real*8::eta
    
    !!jacob(elbm)=(y((nne-1)*elbm+1)-y((nne-1)*(elbm-1)+1))/2.0d0
    !eta_phy=((y((nne-1)*elbm+1)-y((nne-1)*(elbm-1)+1))/2.0d0)*(eta+1.0d0)+y((nne-1)*(elbm-1)+1)
    !call mat_stiff(ele,cs,eta_phy)
    
    SELECT CASE(nne)
        CASE (2)
        sf(1)=0.5d0*(1.0-eta); sf(2)=0.5d0*(1.0+eta)
        dsf(1)=(-0.5d0); dsf(2)=0.5d0
        CASE (3)
        sf(1)=(0.5d0*eta*(eta-1.0d0)); sf(2)=(1.0d0+eta)*(1.0d0-eta); sf(3)=(0.5d0*eta*(eta+1.0d0))
        dsf(1)=(eta-0.5d0); dsf(2)=-2.0d0*eta; dsf(3)=(eta+0.5d0)
        CASE (4)
        sf(1)=(-9.0d0/16.0d0)*(eta-1.0d0)*(eta+(1.0d0/3.0d0))*(eta-(1.0d0/3.0d0))
        sf(2)=(27.0d0/16.0d0)*(eta+1.0d0)*(eta-(1.0d0/3.0d0))*(eta-1.0d0)
        sf(3)=(-27.0d0/16.0d0)*(eta+1.0d0)*(eta+(1.0d0/3.0d0))*(eta-1.0d0)
        sf(4)=(9.0d0/16.0d0)*(eta+1.0d0)*(eta+(1.0d0/3.0d0))*(eta-(1.0d0/3.0d0))
        dsf(1)=(-9.0d0/16.0d0)*(3.0d0*(eta**2)-(2.0d0*eta)-(1.0d0/9.0d0))
        dsf(2)=(27.0d0/16.0d0)*(3.0d0*(eta**2)-((2.0d0/3.0d0)*eta)-1.0d0)
        dsf(3)=(-27.0d0/16.0d0)*(3.0d0*(eta**2)+((2.0d0/3.0d0)*eta)-1.0d0)
        dsf(4)=(9.0d0/16.0d0)*(3.0d0*(eta**2)+(2.0d0*eta)-(1.0d0/9.0d0))
        CASE (5)
        sf(1)=(2.0d0/3.0d0)*(eta-1)*(eta+0.5d0)*(eta-0.5d0)*eta
        sf(2)=(-8.0d0/3.0d0)*(eta+1)*(eta-1)*(eta-0.5d0)*eta
        sf(3)=4.0*(eta+1)*(eta-1)*(eta+0.5d0)*(eta-0.5d0)
        sf(4)=(-8.0d0/3.0d0)*(eta+1)*(eta-1)*(eta+0.5d0)*eta
        sf(5)=(2.0d0/3.0d0)*(eta+1)*(eta+0.5d0)*(eta-0.5d0)*eta
        dsf(1)=(8.0d0/3.0d0)*((eta**3)-0.75d0*(eta**2)-0.125d0*eta+0.0625d0)
        dsf(2)=(-32.0d0/3.0d0)*((eta**3)-0.375d0*(eta**2)-0.5d0*eta+0.125d0)
        dsf(3)=16.0d0*((eta**3)-0.625d0*eta)
        dsf(4)=(-32.0d0/3.0d0)*((eta**3)+0.375d0*(eta**2)-0.5*eta-0.125d0)
        dsf(5)=(8.0d0/3.0d0)*((eta**3)+0.75d0*(eta**2)-0.125*eta-0.0625d0)
        END SELECT
        
    return
end subroutine


    subroutine expfun_cs(ele_cs,alpha,beta)
    use var_inputdata
    use var_analysis
    
    implicit none
    real*8::alpha,beta,sq3
    real*8::l1l2,l1l2_a,l1l2_b,l2l3,l2l3_a,l2l3_b,l3l1,l3l1_a,l3l1_b,l1l2l3,l1l2l3_a,l1l2l3_b,l21,l32,l13,l21_a,l32_a,l13_a,l21_b,l32_b,l13_b,l2l3min1,l2l3min1_a,l2l3min1_b
	real*8::l1,l2,l3,l1_a,l2_a,l3_a,l1_b,l2_b,l3_b
    integer::ele_cs
    
    sq3=sqrt(3.0d0)
    
    if (cs_ele_type(ele_cs,2).eq.3) then                    ! tri element
		l1=0.5d0*(1.0d0-alpha-beta/sq3)  
		l2=0.5d0*(1.0d0+alpha-beta/sq3) 
		l3=beta/sq3
		
		l1_a=-0.5d0
		l2_a=0.5d0
		l3_a=0.0d0
		
		l1_b=-0.5d0*(1.0d0/sq3)
		l2_b=-0.5d0*(1.0d0/sq3)
		l3_b=1.0d0/sq3
		
        l1l2=0.25d0*((1-beta/sq3)**2-alpha**2)
        l1l2_a=0.25d0*(-2.0d0*alpha)
        l1l2_b=0.25d0*(2.0d0*(1-beta/sq3)*(-1.0d0/sq3))
        
        l2l3=0.5d0*(beta/sq3+alpha*beta/sq3-(beta/sq3)**2)
        l2l3_a=0.5d0*(beta/sq3)
        l2l3_b=0.5d0*(1.0d0/sq3+alpha/sq3-2.0d0*beta/3.0d0)
        
        l3l1=0.5d0*(beta/sq3-alpha*beta/sq3-(beta/sq3)**2)
        l3l1_a=-0.5d0*(beta/sq3)
        l3l1_b=0.5d0*(1.0d0/sq3-alpha/sq3-2.0d0*beta/3.0d0)
        
        l1l2l3=(0.25d0/sq3)*((beta**3)/3.0d0-2.0d0*(beta**2)/sq3-beta*alpha**2+beta)
        l1l2l3_a=(-0.25d0/sq3)*(2.0d0*beta*alpha)
        l1l2l3_b=(0.25d0/sq3)*((beta**2)-4.0d0*beta/sq3-alpha**2+1.0d0)
        
        l21=alpha; l21_a=1.0d0; l21_b=0.0d0
        l32=0.5d0*(sq3*beta-alpha-1.0d0); l32_a=-0.5d0; l32_b=0.5d0*sq3
        l13=-0.5d0*(sq3*beta+alpha-1.0d0); l13_a=-0.5d0; l13_b=-0.5d0*sq3
        
        l2l3min1=2.0d0*beta/sq3-1.0d0; l2l3min1_a=0.0d0; l2l3min1_b=2.0d0/sq3
        
		!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
        f(1)=l1
        f(2)=l2
        f(3)=l3
        f(4)=0.0d0
          
        fa(1)=l1_a
        fa(2)=l2_a
        fa(3)=l3_a
        fa(4)=0.0d0
          
        fb(1)=l1_b
        fb(2)=l2_b
        fb(3)=l3_b
        fb(4)=0.0d0
          
        if (mexp.eq.4) then
            GOTO 2005
        endif
        !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!  
        !!!! Lagrange !!!! side: L1L2*(4/1-s**2)*phi(s) !!! Eq. 5.32 of Babuska
        f(5)=-4.0d0*l1l2
        f(6)=-4.0d0*l2l3
        f(7)=-4.0d0*l3l1
        f(8)=0.0d0
        
        fa(5)=-4.0d0*l1l2_a
        fa(6)=-4.0d0*l2l3_a
        fa(7)=-4.0d0*l3l1_a
        fa(8)=0.0d0
          
        fb(5)=-4.0d0*l1l2_b
        fb(6)=-4.0d0*l2l3_b
        fb(7)=-4.0d0*l3l1_b
        fb(8)=0.0d0
        
        !!!! Legendre
        !f(5)=-l1l2*sqrt(6.0d0)
        !f(6)=-l2l3*sqrt(6.0d0)
        !f(7)=-l3l1*sqrt(6.0d0)
        !f(8)=0.0d0
        !  
        !fa(5)=-l1l2_a*sqrt(6.0d0)
        !fa(6)=-l2l3_a*sqrt(6.0d0)
        !fa(7)=-l3l1_a*sqrt(6.0d0)
        !fa(8)=0.0d0
        !  
        !fb(5)=-l1l2_b*sqrt(6.0d0)
        !fb(6)=-l2l3_b*sqrt(6.0d0)
        !fb(7)=-l3l1_b*sqrt(6.0d0)
        !fb(8)=0.0d0
    
        if (mexp.eq.8) then
            GOTO 2005
        endif
        
        !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!  
        ! Lagrange
        f(9)=-4.0d0*l1l2*l21
        f(10)=-4.0d0*l2l3*l32
        f(11)=-4.0d0*l3l1*l13
        f(12)=l1l2l3
          
        fa(9)=-4.0d0*l1l2*l21_a-4.0d0*l1l2_a*l21
        fa(10)=-4.0d0*l2l3*l32_a-4.0d0*l2l3_a*l32
        fa(11)=-4.0d0*l3l1*l13_a-4.0d0*l3l1_a*l13
        fa(12)=l1l2l3_a
          
        fb(9)=-4.0d0*l1l2*l21_b-4.0d0*l1l2_b*l21
        fb(10)=-4.0d0*l2l3*l32_b-4.0d0*l2l3_b*l32
        fb(11)=-4.0d0*l3l1*l13_b-4.0d0*l3l1_b*l13
        fb(12)=l1l2l3_b
          
        ! Legendre
        !f(9)=-sqrt(10.0d0)*l21*l1l2
        !f(10)=-sqrt(10.0d0)*l32*l2l3
        !f(11)=-sqrt(10.0d0)*l13*l3l1
        !f(12)=l1l2l3
        !  
        !fa(9)=-sqrt(10.0d0)*l21_a*l1l2-sqrt(10.0d0)*l21*l1l2_a     
        !fa(10)=-sqrt(10.0d0)*l32_a*l2l3-sqrt(10.0d0)*l32*l2l3_a
        !fa(11)=-sqrt(10.0d0)*l13_a*l3l1-sqrt(10.0d0)*l13*l3l1_a
        !fa(12)=l1l2l3_a
        !  
        !fb(9)=-sqrt(10.0d0)*l21_b*l1l2-sqrt(10.0d0)*l21*l1l2_b   
        !fb(10)=-sqrt(10.0d0)*l32_b*l2l3-sqrt(10.0d0)*l32*l2l3_b
        !fb(11)=-sqrt(10.0d0)*l13_b*l3l1-sqrt(10.0d0)*l13*l3l1_b
        !fb(12)=l1l2l3_b
          
        if (mexp.eq.12) then
            GOTO 2005
        endif
        
        !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!  
        ! Lagrange  
        f(13)=-4.0d0*l1l2*(l21**2-1.0d0/9.0d0) 
        f(14)=-4.0d0*l2l3*(l32**2-1.0d0/9.0d0)
        f(15)=-4.0d0*l3l1*(l13**2-1.0d0/9.0d0)
        f(16)=l3*(l2)*(l1**2)	
        f(17)=l3*(l2**2)*(l1)	
          
        fa(13)=-4.0d0*l1l2_a*(l21**2-1.0d0/9.0d0)-4.0d0*l1l2*(2.0d0*l21*l21_a)     
        fa(14)=-4.0d0*l2l3_a*(l32**2-1.0d0/9.0d0)-4.0d0*l2l3*(2.0d0*l32*l32_a) 
        fa(15)=-4.0d0*l3l1_a*(l13**2-1.0d0/9.0d0)-4.0d0*l3l1*(2.0d0*l13*l13_a)
        fa(16)=l3_a*(l2)*(l1**2)+l3*(l2_a)*(l1**2)+l3*(l2)*(2.0d0*l1*l1_a)	
        fa(17)=l3_a*(l2**2)*(l1)+l3*(2.0d0*l2*l2_a)*(l1)+l3*(l2**2)*(l1_a)	
          
        fb(13)=-4.0d0*l1l2_b*(l21**2-1.0d0/9.0d0)-4.0d0*l1l2*(2.0d0*l21*l21_b)    
        fb(14)=-4.0d0*l2l3_b*(l32**2-1.0d0/9.0d0)-4.0d0*l2l3*(2.0d0*l32*l32_b)  
        fb(15)=-4.0d0*l3l1_b*(l13**2-1.0d0/9.0d0)-4.0d0*l3l1*(2.0d0*l13*l13_b) 
        fb(16)=l3_b*(l2)*(l1**2)+l3*(l2_b)*(l1**2)+l3*(l2)*(2.0d0*l1*l1_b)
        fb(17)=l3_b*(l2**2)*(l1)+l3*(2.0d0*l2*l2_b)*(l1)+l3*(l2**2)*(l1_b)
        
        ! Legendre
  !      f(13)=-sqrt(7.0d0/8.0d0)*(5.0d0*l21**2-1.0d0)*l1l2    
  !      f(14)=-sqrt(7.0d0/8.0d0)*(5.0d0*l32**2-1.0d0)*l2l3                    
  !      f(15)=-sqrt(7.0d0/8.0d0)*(5.0d0*l13**2-1.0d0)*l3l1   
  !		!f(16)=l3*(l2)*(l1**2)			
  !      !f(17)=l3*(l2**2)*(l1)			 
  !      f(16)=l1l2l3*l21
  !      f(17)=l1l2l3*l2l3min1                       
  !        
  !      fa(13)=-sqrt(7.0d0/8.0d0)*(5.0d0*l21**2-1.0d0)*l1l2_a-sqrt(7.0d0/8.0d0)*(10.0d0*l21*l21_a)*l1l2   
  !      fa(14)=-sqrt(7.0d0/8.0d0)*(5.0d0*l32**2-1.0d0)*l2l3_a-sqrt(7.0d0/8.0d0)*(10.0d0*l32*l32_a)*l2l3  
  !      fa(15)=-sqrt(7.0d0/8.0d0)*(5.0d0*l13**2-1.0d0)*l3l1_a-sqrt(7.0d0/8.0d0)*(10.0d0*l13*l13_a)*l3l1  
  !      !fa(16)=l3_a*(l2)*(l1**2)+l3*(l2_a)*(l1**2)+l3*(l2)*(2.0d0*l1*l1_a)			
  !      !fa(17)=l3_a*(l2**2)*(l1)+l3*(2.0d0*l2*l2_a)*(l1)+l3*(l2**2)*(l1_a)			
		!fa(16)=l1l2l3_a*l21+l1l2l3*l21_a
  !      fa(17)=l1l2l3_a*l2l3min1+l1l2l3*l2l3min1_a 
  !        
  !      fb(13)=-sqrt(7.0d0/8.0d0)*(5.0d0*l21**2-1.0d0)*l1l2_b-sqrt(7.0d0/8.0d0)*(10.0d0*l21*l21_b)*l1l2  
  !      fb(14)=-sqrt(7.0d0/8.0d0)*(5.0d0*l32**2-1.0d0)*l2l3_b-sqrt(7.0d0/8.0d0)*(10.0d0*l32*l32_b)*l2l3  
  !      fb(15)=-sqrt(7.0d0/8.0d0)*(5.0d0*l13**2-1.0d0)*l3l1_b-sqrt(7.0d0/8.0d0)*(10.0d0*l13*l13_b)*l3l1  
  !      !fb(16)=l3_b*(l2)*(l1**2)+l3*(l2_b)*(l1**2)+l3*(l2)*(2.0d0*l1*l1_b)		
  !      !fb(17)=l3_b*(l2**2)*(l1)+l3*(2.0d0*l2*l2_b)*(l1)+l3*(l2**2)*(l1_b)		
		!fb(16)=l1l2l3_b*l21+l1l2l3*l21_b
  !      fb(17)=l1l2l3_b*l2l3min1+l1l2l3*l2l3min1_b   
        
        if (mexp.eq.17) then
            GOTO 2005
		endif
		
		!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!  
		! Lagrange 
		f(18)=-4.0d0*l1l2*l21*(l21**2-1.0d0/4.0d0) 
		f(19)=-4.0d0*l2l3*l32*(l32**2-1.0d0/4.0d0) 
		f(20)=-4.0d0*l3l1*l13*(l13**2-1.0d0/4.0d0) 
		f(21)=l3*(l2)*(l1**3)		
		f(22)=l3*(l2**2)*(l1**2)	
		f(23)=l3*(l2**3)*(l1)		
  
		fa(18)=-4.0d0*l1l2_a*(l21**3-0.25d0*l21)-4.0d0*l1l2*(3.0d0*(l21**2)*l21_a-0.25d0*l21_a)
		fa(19)=-4.0d0*l2l3_a*(l32**3-0.25d0*l32)-4.0d0*l2l3*(3.0d0*(l32**2)*l32_a-0.25d0*l32_a)
		fa(20)=-4.0d0*l3l1_a*(l13**3-0.25d0*l13)-4.0d0*l3l1*(3.0d0*(l13**2)*l13_a-0.25d0*l13_a)
		fa(21)=l3_a*(l2)*(l1**3)+l3*(l2_a)*(l1**3)+l3*(l2)*(3.0d0*l1**2)*l1_a
		fa(22)=l3_a*(l2**2)*(l1**2)+l3*(2.0d0*l2*l2_a)*(l1**2)+l3*(l2**2)*(2.0d0*l1*l1_a)
		fa(23)=l3_a*(l2**3)*(l1)+l3*(3.0d0*l2**2)*l2_a*(l1)+l3*(l2**3)*(l1_a)
   
		fb(18)=-4.0d0*l1l2_b*(l21**3-0.25d0*l21)-4.0d0*l1l2*(3.0d0*(l21**2)*l21_b-0.25d0*l21_b)
		fb(19)=-4.0d0*l2l3_b*(l32**3-0.25d0*l32)-4.0d0*l2l3*(3.0d0*(l32**2)*l32_b-0.25d0*l32_b)
		fb(20)=-4.0d0*l3l1_b*(l13**3-0.25d0*l13)-4.0d0*l3l1*(3.0d0*(l13**2)*l13_b-0.25d0*l13_b)
		fb(21)=l3_b*(l2)*(l1**3)+l3*(l2_b)*(l1**3)+l3*(l2)*(3.0d0*l1**2)*l1_b
		fb(22)=l3_b*(l2**2)*(l1**2)+l3*(2.0d0*l2*l2_b)*(l1**2)+l3*(l2**2)*(2.0d0*l1*l1_b)
		fb(23)=l3_b*(l2**3)*(l1)+l3*(3.0d0*l2**2)*l2_b*(l1)+l3*(l2**3)*(l1_b)
		
		! Legendre 
     !   f(18)=-sqrt(9.0d0/8.0d0)*(7.0d0*l21**3-3.0d0*l21)*l1l2
     !   f(19)=-sqrt(9.0d0/8.0d0)*(7.0d0*l32**3-3.0d0*l32)*l2l3
     !   f(20)=-sqrt(9.0d0/8.0d0)*(7.0d0*l13**3-3.0d0*l13)*l3l1
     !   !f(21)=l3*(l2)*(l1**3)				
     !   !f(22)=l3*(l2**2)*(l1**2)			
     !   !f(23)=l3*(l2**3)*(l1)				
     !
  		 !f(21)=l1l2l3*0.5d0*(3.0d0*l21**2-1.0d0)
     !   f(22)=l1l2l3*l21*l2l3min1
     !   f(23)=l1l2l3*0.5d0*(3.0d0*l2l3min1**2-1.0d0)
     !     
     !   fa(18)=-sqrt(9.0d0/8.0d0)*(7.0d0*l21**3-3.0d0*l21)*l1l2_a-sqrt(9.0d0/8.0d0)*(21.0d0*(l21**2)*l21_a-3.0d0*l21_a)*l1l2
     !   fa(19)=-sqrt(9.0d0/8.0d0)*(7.0d0*l32**3-3.0d0*l32)*l2l3_a-sqrt(9.0d0/8.0d0)*(21.0d0*(l32**2)*l32_a-3.0d0*l32_a)*l2l3
     !   fa(20)=-sqrt(9.0d0/8.0d0)*(7.0d0*l13**3-3.0d0*l13)*l3l1_a-sqrt(9.0d0/8.0d0)*(21.0d0*(l13**2)*l13_a-3.0d0*l13_a)*l3l1
  		 !!fa(21)=l3_a*(l2)*(l1**3)+l3*(l2_a)*(l1**3)+l3*(l2)*(3.0d0*l1**2)*l1_a
  		 !!fa(22)=l3_a*(l2**2)*(l1**2)+l3*(2.0d0*l2*l2_a)*(l1**2)+l3*(l2**2)*(2.0d0*l1*l1_a)
  		 !!fa(23)=l3_a*(l2**3)*(l1)+l3*(3.0d0*l2**2)*l2_a*(l1)+l3*(l2**3)*(l1_a)
     !
  		 !fa(21)=l1l2l3_a*0.5d0*(3.0d0*l21**2-1.0d0)+l1l2l3*0.5d0*(6.0d0*l21*l21_a)
  		 !fa(22)=l1l2l3_a*l21*l2l3min1+l1l2l3*l21_a*l2l3min1+l1l2l3*l21*l2l3min1_a
  		 !fa(23)=l1l2l3_a*0.5d0*(3.0d0*l2l3min1**2-1.0d0)+l1l2l3*0.5d0*(6.0d0*l2l3min1*l2l3min1_a)
     !     
     !   fb(18)=-sqrt(9.0d0/8.0d0)*(7.0d0*l21**3-3.0d0*l21)*l1l2_b-sqrt(9.0d0/8.0d0)*(21.0d0*(l21**2)*l21_b-3.0d0*l21_b)*l1l2
     !   fb(19)=-sqrt(9.0d0/8.0d0)*(7.0d0*l32**3-3.0d0*l32)*l2l3_b-sqrt(9.0d0/8.0d0)*(21.0d0*(l32**2)*l32_b-3.0d0*l32_b)*l2l3
     !   fb(20)=-sqrt(9.0d0/8.0d0)*(7.0d0*l13**3-3.0d0*l13)*l3l1_b-sqrt(9.0d0/8.0d0)*(21.0d0*(l13**2)*l13_b-3.0d0*l13_b)*l3l1
  		 !!fb(21)=l3_b*(l2)*(l1**3)+l3*(l2_b)*(l1**3)+l3*(l2)*(3.0d0*l1**2)*l1_b
     !!   fb(22)=l3_b*(l2**2)*(l1**2)+l3*(2.0d0*l2*l2_b)*(l1**2)+l3*(l2**2)*(2.0d0*l1*l1_b)
     !!   fb(23)=l3_b*(l2**3)*(l1)+l3*(3.0d0*l2**2)*l2_b*(l1)+l3*(l2**3)*(l1_b)
     !
     !   fb(21)=l1l2l3_b*0.5d0*(3.0d0*l21**2-1.0d0)+l1l2l3*0.5d0*(6.0d0*l21*l21_b)
     !   fb(22)=l1l2l3_b*l21*l2l3min1+l1l2l3*l21_b*l2l3min1+l1l2l3*l21*l2l3min1_b
     !   fb(23)=l1l2l3_b*0.5d0*(3.0d0*l2l3min1**2-1.0d0)+l1l2l3*0.5d0*(6.0d0*l2l3min1*l2l3min1_b)
		
        if (mexp.eq.23) then
            GOTO 2005
		endif
		
		!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!  
		! Lagrange 
        f(24)=-4.0d0*l1l2*(l21**2-1.0d0/25.0d0)*(l21**2-9.0d0/25.0d0)  
        f(25)=-4.0d0*l2l3*(l32**2-1.0d0/25.0d0)*(l32**2-9.0d0/25.0d0) 
        f(26)=-4.0d0*l3l1*(l13**2-1.0d0/25.0d0)*(l13**2-9.0d0/25.0d0) 
        f(27)=l3*(l2)*(l1**4)	
        f(28)=l3*(l2**2)*(l1**3)
        f(29)=l3*(l2**3)*(l1**2)	
        f(30)=l3*(l2**4)*(l1)	
          
        fa(24)=-4.0d0*l1l2_a*(l21**4-0.4d0*l21**2+9.0d0/625.0d0)-4.0d0*l1l2*(4.0d0*l21_a*l21**3-0.8d0*l21*l21_a)    
        fa(25)=-4.0d0*l2l3_a*(l32**4-0.4d0*l32**2+9.0d0/625.0d0)-4.0d0*l2l3*(4.0d0*l32_a*l32**3-0.8d0*l32*l32_a)
        fa(26)=-4.0d0*l3l1_a*(l13**4-0.4d0*l13**2+9.0d0/625.0d0)-4.0d0*l3l1*(4.0d0*l13_a*l13**3-0.8d0*l13*l13_a)
        fa(27)=l3_a*(l2)*(l1**4)+l3*(l2_a)*(l1**4)+l3*(l2)*(4.0d0*l1_a*l1**3)
        fa(28)=l3_a*(l2**2)*(l1**3)+l3*(2.0d0*l2*l2_a)*(l1**3)+l3*(l2**2)*(3.0d0*l1_a*l1**2)
        fa(29)=l3_a*(l2**3)*(l1**2)+l3*(3.0d0*l2_a*l2**2)*(l1**2)+l3*(l2**3)*(2.0d0*l1*l1_a)
        fa(30)=l3_a*(l2**4)*(l1)+l3*(4.0d0*l2_a*l2**3)*(l1)+l3*(l2**4)*(l1_a)	
          
        fb(24)=-4.0d0*l1l2_b*(l21**4-0.4d0*l21**2+9.0d0/625.0d0)-4.0d0*l1l2*(4.0d0*l21_b*l21**3-0.8d0*l21*l21_b)
        fb(25)=-4.0d0*l2l3_b*(l32**4-0.4d0*l32**2+9.0d0/625.0d0)-4.0d0*l2l3*(4.0d0*l32_b*l32**3-0.8d0*l32*l32_b)
        fb(26)=-4.0d0*l3l1_b*(l13**4-0.4d0*l13**2+9.0d0/625.0d0)-4.0d0*l3l1*(4.0d0*l13_b*l13**3-0.8d0*l13*l13_b)
        fb(27)=l3_b*(l2)*(l1**4)+l3*(l2_b)*(l1**4)+l3*(l2)*(4.0d0*l1_b*l1**3)
        fb(28)=l3_b*(l2**2)*(l1**3)+l3*(2.0d0*l2*l2_b)*(l1**3)+l3*(l2**2)*(3.0d0*l1_b*l1**2)
        fb(29)=l3_b*(l2**3)*(l1**2)+l3*(3.0d0*l2_b*l2**2)*(l1**2)+l3*(l2**3)*(2.0d0*l1*l1_b)
        fb(30)=l3_b*(l2**4)*(l1)+l3*(4.0d0*l2_b*l2**3)*(l1)+l3*(l2**4)*(l1_b)	
          
        if (mexp.eq.30) then
            GOTO 2005
        endif
        
    elseif (cs_ele_type(ele_cs,2).eq.4) then                !!!!!!!!!!!!!!!!!!!!! quad element!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
        f(1)=0.25d0*(1.0d0-alpha)*(1.0d0-beta)   
        f(2)=0.25d0*(1.0d0+alpha)*(1.0d0-beta)
        f(3)=0.25d0*(1.0d0+alpha)*(1.0d0+beta)
        f(4)=0.25d0*(1.0d0-alpha)*(1.0d0+beta) 
          
        fa(1)=-0.25d0*(1.0d0-beta)   
        fa(2)=0.25d0*(1.0d0-beta)
        fa(3)=0.25d0*(1.0d0+beta)
        fa(4)=-0.25d0*(1.0d0+beta)
          
        fb(1)=-0.25d0*(1.0d0-alpha)  
        fb(2)=-0.25d0*(1.0d0+alpha)
        fb(3)=0.25d0*(1.0d0+alpha)
        fb(4)=0.25d0*(1.0d0-alpha)
          
        if (mexp.eq.4) then
            GOTO 2005
        endif
    !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!         
          
        f(5)=0.5d0*(1.0d0-beta)*((alpha**2)-1.0d0)
        f(6)=0.5d0*(1.0d0+alpha)*((beta**2)-1.0d0)
        f(7)=0.5d0*(1.0d0+beta)*((alpha**2)-1.0d0)
        f(8)=0.5d0*(1.0d0-alpha)*((beta**2)-1.0d0)
          
        fa(5)=0.5d0*(1.0d0-beta)*(2.0d0*alpha)
        fa(6)=0.5d0*((beta**2)-1.0d0)
        fa(7)=0.5d0*(1.0d0+beta)*(2.0d0*alpha)
        fa(8)=-0.5d0*((beta**2)-1.0d0)
          
        fb(5)=-0.5d0*((alpha**2)-1.0d0)
        fb(6)=0.5d0*(1.0d0+alpha)*(2.0d0*beta)
        fb(7)=0.5d0*((alpha**2)-1.0d0)
        fb(8)=0.5d0*(1.0d0-alpha)*(2.0d0*beta)
          
        if (mexp.eq.8) then
            GOTO 2005
        endif
    !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!  
        f(9)=0.5d0*(1.0d0-beta)*((alpha**3)-alpha)
        f(10)=0.5d0*(1.0d0+alpha)*((beta**3)-beta)
        f(11)=0.5d0*(1.0d0+beta)*(-1.0d0*(alpha**3)+alpha)
        f(12)=0.5d0*(1.0d0-alpha)*(-1.0d0*(beta**3)+beta)
          
        fa(9)=0.5d0*(1.0d0-beta)*(3.0d0*(alpha**2)-1.0d0)
        fa(10)=0.5d0*((beta**3)-beta)
        fa(11)=0.5d0*(1.0d0+beta)*(-3.0d0*(alpha**2)+1.0d0)
        fa(12)=-0.5d0*(-1.0d0*(beta**3)+beta)
          
        fb(9)=-0.5d0*((alpha**3)-alpha)
        fb(10)=0.5d0*(1.0d0+alpha)*(3.0d0*(beta**2)-1.0d0)
        fb(11)=0.5d0*(-1.0d0*(alpha**3)+alpha)
        fb(12)=0.5d0*(1.0d0-alpha)*(-3.0d0*(beta**2)+1.0d0)
          
        if (mexp.eq.12) then
            GOTO 2005
        endif
    !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!  
        f(13)=0.5d0*(1.0d0-beta)*((alpha**4)-(10.0d0/9.0d0)*(alpha**2)+(1.0d0/9.0d0))
        f(14)=0.5d0*(1.0d0+alpha)*((beta**4)-(10.0d0/9.0d0)*(beta**2)+(1.0d0/9.0d0))
        f(15)=0.5d0*(1.0d0+beta)*((alpha**4)-(10.0d0/9.0d0)*(alpha**2)+(1.0d0/9.0d0))
        f(16)=0.5d0*(1.0d0-alpha)*((beta**4)-(10.0d0/9.0d0)*(beta**2)+(1.0d0/9.0d0))
        f(17)=((alpha**2)-1.0d0)*((beta**2)-1.0d0) 
          
        fa(13)=0.5d0*(1.0d0-beta)*(4.0*(alpha**3)-(20.0d0/9.0d0)*alpha)
        fa(14)=0.5d0*((beta**4)-(10.0d0/9.0d0)*(beta**2)+(1.0d0/9.0d0))
        fa(15)=0.5d0*(1.0d0+beta)*(4.0*(alpha**3)-(20.0d0/9.0d0)*alpha)
        fa(16)=-0.5d0*((beta**4)-(10.0d0/9.0d0)*(beta**2)+(1.0d0/9.0d0))
        fa(17)=(2.0d0*alpha)*((beta**2)-1.0d0)
          
        fb(13)=-0.5d0*((alpha**4)-(10.0d0/9.0d0)*(alpha**2)+(1.0d0/9.0d0))
        fb(14)=0.5d0*(1.0d0+alpha)*(4.0*(beta**3)-(20.0d0/9.0d0)*beta)
        fb(15)=0.5d0*((alpha**4)-(10.0d0/9.0d0)*(alpha**2)+(1.0d0/9.0d0))
        fb(16)=0.5d0*(1.0d0-alpha)*(4.0*(beta**3)-(20.0/9.0)*beta)
        fb(17)=(2.0d0*beta)*((alpha**2)-1.0d0)
          
        if (mexp.eq.17) then
            GOTO 2005
        endif
    !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!  
        f(18)=0.5d0*(1.0d0-beta)*((alpha**5)-(5.0d0/4.0d0)*(alpha**3)+(1.0d0/4.0d0)*alpha)
        f(19)=0.5d0*(1.0d0+alpha)*((beta**5)-(5.0d0/4.0d0)*(beta**3)+(1.0d0/4.0d0)*beta)
        f(20)=0.5d0*(1.0d0+beta)*(-1.0d0*(alpha**5)+(5.0d0/4.0d0)*(alpha**3)-(1.0d0/4.0d0)*alpha)
        f(21)=0.5d0*(1.0d0-alpha)*(-1.0d0*(beta**5)+(5.0d0/4.0d0)*(beta**3)-(1.0d0/4.0d0)*beta)
        f(22)=((alpha**2)-1.0d0)*((beta**3)-beta)
        f(23)=((beta**2)-1.0d0)*((alpha**3)-alpha)  
          
        fa(18)=0.5d0*(1.0d0-beta)*(5.0d0*(alpha**4)-(15.0d0/4.0d0)*(alpha**2)+0.25d0)
        fa(19)=0.5d0*((beta**5)-(5.0d0/4.0d0)*(beta**3)+(0.25d0*beta))
        fa(20)=0.5d0*(1.0d0+beta)*(-5.0d0*(alpha**4)+(15.0d0/4.0d0)*(alpha**2)-0.25d0)
        fa(21)=-0.5d0*(-1.0d0*(beta**5)+(5.0d0/4.0d0)*(beta**3)-(1.0d0/4.0d0)*beta)
        fa(22)=(2.0*alpha)*((beta**3)-beta)
        fa(23)=((beta**2)-1.0d0)*(3.0*(alpha**2)-1.0d0)
          
        fb(18)=-0.5d0*((alpha**5)-(5.0d0/4.0d0)*(alpha**3)+0.25d0*alpha)
        fb(19)=0.5d0*(1.0d0+alpha)*(5.0d0*(beta**4)-(15.0/4.0)*(beta**2)+0.25d0)
        fb(20)=0.5d0*(-1.0d0*(alpha**5)+(5.0d0/4.0d0)*(alpha**3)-(1.0d0/4.0d0)*alpha)
        fb(21)=0.5d0*(1.0d0-alpha)*(-5.0d0*(beta**4)+(15.0d0/4.0d0)*(beta**2)-0.25d0)
        fb(22)=((alpha**2)-1.0d0)*(3.0*(beta**2)-1.0d0)
        fb(23)=(2.0*beta)*((alpha**3)-alpha)
          
        if (mexp.eq.23) then
            GOTO 2005
        endif
    !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!  
          
        f(24)=0.5d0*(1.0d0-beta)*((alpha**6)-(7.0d0/5.0d0)*(alpha**4)+(259.0d0/625.0d0)*(alpha**2)-(9.0d0/625.0d0))
        f(25)=0.5d0*(1.0d0+alpha)*((beta**6)-(7.0d0/5.0d0)*(beta**4)+(259.0d0/625.0d0)*(beta**2)-(9.0d0/625.0d0))
        f(26)=0.5d0*(1.0d0+beta)*((alpha**6)-(7.0d0/5.0d0)*(alpha**4)+(259.0d0/625.0d0)*(alpha**2)-(9.0d0/625.0d0))
        f(27)=0.5d0*(1.0d0-alpha)*((beta**6)-(7.0d0/5.0d0)*(beta**4)+(259.0d0/625.0d0)*(beta**2)-(9.0d0/625.0d0))
        f(28)=((alpha**4)-(10.0d0/9.0d0)*(alpha**2)+(1.0d0/9.0d0))*((beta**2)-1.0d0)
        f(29)=((alpha**3)-alpha)*((beta**3)-beta)
        f(30)=((alpha**2)-1.0d0)*((beta**4)-(10.0d0/9.0d0)*(beta**2)+(1.0d0/9.0d0)) 
          
        fa(24)=0.5d0*(1.0d0-beta)*(6.0*(alpha**5)-(28.0d0/5.0d0)*(alpha**3)+(518.0d0/625.0d0)*alpha)
        fa(25)=0.5d0*((beta**6)-(7.0d0/5.0d0)*(beta**4)+(259.0d0/625.0d0)*(beta**2)-(9.0d0/625.0d0))
        fa(26)=0.5d0*(1.0d0+beta)*(6.0*(alpha**5)-(28.0/5.0)*(alpha**3)+(518.0d0/625.0d0)*alpha)
        fa(27)=-0.5d0*((beta**6)-(7.0d0/5.0d0)*(beta**4)+(259.0d0/625.0d0)*(beta**2)-(9.0d0/625.0d0))
        fa(28)=(4.0d0*(alpha**3)-(20.0d0/9.0d0)*alpha)*((beta**2)-1.0d0)
        fa(29)=(3.0d0*(alpha**2)-1.0d0)*((beta**3)-beta)
        fa(30)=(2.0d0*alpha)*((beta**4)-(10.0d0/9.0d0)*(beta**2)+(1.0d0/9.0d0))
          
        fb(24)=-0.5d0*((alpha**6)-(7.0d0/5.0d0)*(alpha**4)+(259.0d0/625.0d0)*(alpha**2)-(9.0d0/625.0d0))
        fb(25)=0.5d0*(1.0d0+alpha)*(6.0*(beta**5)-(28.0d0/5.0d0)*(beta**3)+(518.0d0/625.0d0)*beta)
        fb(26)=0.5d0*((alpha**6)-(7.0d0/5.0d0)*(alpha**4)+(259.0d0/625.0d0)*(alpha**2)-(9.0d0/625.0d0))
        fb(27)=0.5d0*(1.0d0-alpha)*(6.0*(beta**5)-(28.0d0/5.0d0)*(beta**3)+(518.0d0/625.0d0)*beta)
        fb(28)=((alpha**4)-(10.0d0/9.0d0)*(alpha**2)+(1.0d0/9.0d0))*(2.0*beta)
        fb(29)=((alpha**3)-alpha)*(3.0*(beta**2)-1.0d0)
        fb(30)=((alpha**2)-1.0d0)*(4.0*(beta**3)-(20.0/9.0)*beta)
          
        if (mexp.eq.30) then
            GOTO 2005
        endif
    !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!  
        f(31)=0.5d0*(1.0d0-beta)*((alpha**7)-(14.0d0/9.0d0)*(alpha**5)+(49.0d0/81.0d0)*(alpha**3)-(4.0d0/81.0d0)*alpha)
        f(32)=0.5d0*(1.0d0+alpha)*((beta**7)-(14.0d0/9.0d0)*(beta**5)+(49.0d0/81.0d0)*(beta**3)-(4.0d0/81.0d0)*beta)
        f(33)=0.5d0*(1.0d0+beta)*(-1.0d0*(alpha**7)+(14.0d0/9.0d0)*(alpha**5)-(49.0d0/81.0d0)*(alpha**3)+(4.0d0/81.0d0)*alpha)
        f(34)=0.5d0*(1.0d0-alpha)*(-1.0d0*(beta**7)+(14.0d0/9.0d0)*(beta**5)-(49.0d0/81.0d0)*(beta**3)+(4.0d0/81.0d0)*beta) 
        f(35)=((alpha**2)-1.0d0)*((beta**5)-(5.0d0/4.0d0)*(beta**3)+0.25*beta)
        f(36)=((alpha**4)-(10.0d0/9.0d0)*(alpha**2)+(1.0d0/9.0d0))*((beta**3)-beta) 
        f(37)=((alpha**3)-alpha)*((beta**4)-(10.0d0/9.0d0)*(beta**2)+(1.0d0/9.0d0))
        f(38)=((beta**2)-1.0d0)*((alpha**5)-(5.0d0/4.0d0)*(alpha**3)+0.25*alpha)
          
        fa(31)=0.5d0*(1.0d0-beta)*(7.0d0*(alpha**6)-(70.0d0/9.0d0)*(alpha**4)+(147.0d0/81.0d0)*(alpha**2)-(4.0d0/81.0d0))
        fa(32)=0.5d0*((beta**7)-(14.0d0/9.0d0)*(beta**5)+(49.0d0/81.0d0)*(beta**3)-(4.0d0/81.0d0)*beta)
        fa(33)=0.5d0*(1.0d0+beta)*(-7.0d0*(alpha**6)+(70.0/9.0)*(alpha**4)-(147.0/81.0d0)*(alpha**2)+(4.0/81.0d0))
        fa(34)=-0.5d0*(-1.0d0*(beta**7)+(14.0d0/9.0d0)*(beta**5)-(49.0d0/81.0d0)*(beta**3)+(4.0d0/81.0d0)*beta)
        fa(35)=(2.0*alpha)*((beta**5)-(5.0d0/4.0d0)*(beta**3)+0.25*beta)
        fa(36)=(4.0*(alpha**3)-(20.0d0/9.0d0)*alpha)*((beta**3)-beta)
        fa(37)=(3.0*(alpha**2)-1.0d0)*((beta**4)-(10.0d0/9.0d0)*(beta**2)+(1.0d0/9.0d0))
        fa(38)=((beta**2)-1.0d0)*(5.0*(alpha**4)-(15.0d0/4.0d0)*(alpha**2)+0.25)
          
        fb(31)=-0.5d0*((alpha**7)-(14.0d0/9.0d0)*(alpha**5)+(49.0d0/81.0d0)*(alpha**3)-(4.0d0/81.0d0)*alpha)
        fb(32)=0.5d0*(1.0d0+alpha)*(7.0d0*(beta**6)-(70.0d0/9.0d0)*(beta**4)+(147.0d0/81.0d0)*(beta**2)-(4.0d0/81.0d0))   
        fb(33)=0.5d0*(-1.0d0*(alpha**7)+(14.0d0/9.0d0)*(alpha**5)-(49.0d0/81.0d0)*(alpha**3)+(4.0d0/81.0d0)*alpha)
        fb(34)=0.5d0*(1.0d0-alpha)*(-7.0d0*(beta**6)+(70.0d0/9.0d0)*(beta**4)-(147.0d0/81.0d0)*(beta**2)+(4.0d0/81.0d0)) 
        fb(35)=((alpha**2)-1.0d0)*(5.0*(beta**4)-(15.0d0/4.0d0)*(beta**2)+0.25)  
        fb(36)=((alpha**4)-(10.0d0/9.0d0)*(alpha**2)+(1.0d0/9.0d0))*(3.0*(beta**2)-1.0d0) 
        fb(37)=((alpha**3)-alpha)*(4.0*(beta**3)-(20.0d0/9.0d0)*beta)   
        fb(38)=(2.0*beta)*((alpha**5)-(5.0d0/4.0d0)*(alpha**3)+0.25*alpha)
          
        if (mexp.eq.38) then
            GOTO 2005
        endif
    !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!  
        f(39)=0.5d0*(1.0d0-beta)*((alpha**8)-(12.0d0/7.0d0)*(alpha**6)+(282.0d0/343.0d0)*(alpha**4)-(12916.0d0/117649.0d0)*(alpha**2)+(225.0d0/117649.0d0))
        f(40)=0.5d0*(1.0d0+alpha)*((beta**8)-(12.0d0/7.0d0)*(beta**6)+(282.0d0/343.0d0)*(beta**4)-(12916.0d0/117649.0d0)*(beta**2)+(225.0d0/117649.0d0))
        f(41)=0.5d0*(1.0d0+beta)*((alpha**8)-(12.0d0/7.0d0)*(alpha**6)+(282.0d0/343.0d0)*(alpha**4)-(12916.0d0/117649.0d0)*(alpha**2)+(225.0d0/117649.0d0))
        f(42)=0.5d0*(1.0d0-alpha)*((beta**8)-(12.0d0/7.0d0)*(beta**6)+(282.0d0/343.0d0)*(beta**4)-(12916.0d0/117649.0d0)*(beta**2)+(225.0d0/117649.0d0))
        f(43)=((alpha**2)-1.0d0)*((beta**6)-(7.0d0/5.0d0)*(beta**4)+(259.0d0/625.0d0)*(beta**2)-(9.0d0/625.0d0))
        f(44)=((alpha**3)-alpha)*((beta**5)-(5.0d0/4.0d0)*(beta**3)+(1.0d0/4.0d0)*beta)
        f(45)=((alpha**4)-(10.0d0/9.0d0)*(alpha**2)+(1.0d0/9.0d0))*((beta**4)-(10.0d0/9.0d0)*(beta**2)+(1.0d0/9.0d0))
        f(46)=((alpha**5)-(5.0d0/4.0d0)*(alpha**3)+0.25*alpha)*((beta**3)-beta)
        f(47)=((alpha**6)-(7.0d0/5.0d0)*(alpha**4)+(259.0d0/625.0d0)*(alpha**2)-(9.0d0/625.0d0))*((beta**2)-1.0d0)
          
        fa(39)=0.5d0*(1.0d0-beta)*(8.0d0*(alpha**7)-(72.0d0/7.0d0)*(alpha**5)+(1128.0d0/343.0d0)*(alpha**3)-(25832.0d0/117649.0d0)*(alpha))
        fa(40)=0.5d0*((beta**8)-(12.0d0/7.0d0)*(beta**6)+(282.0d0/343.0d0)*(beta**4)-(12916.0d0/117649.0d0)*(beta**2)+(225.0d0/117649.0d0))
        fa(41)=0.5d0*(1.0d0+beta)*(8.0*(alpha**7)-(72.0d0/7.0d0)*(alpha**5)+(1128.0d0/343.0d0)*(alpha**3)-(25832.0d0/117649.0d0)*(alpha))
        fa(42)=-0.5d0*((beta**8)-(12.0d0/7.0d0)*(beta**6)+(282.0d0/343.0d0)*(beta**4)-(12916.0d0/117649.0d0)*(beta**2)+(225.0d0/117649.0d0))
        fa(43)=(2.0*alpha)*((beta**6)-(7.0d0/5.0d0)*(beta**4)+(259.0d0/625.0d0)*(beta**2)-(9.0d0/625.0d0))
        fa(44)=(3.0*(alpha**2)-1.0d0)*((beta**5)-(5.0d0/4.0d0)*(beta**3)+(1.0d0/4.0d0)*beta)
        fa(45)=(4.0*(alpha**3)-(20.0d0/9.0d0)*alpha)*((beta**4)-(10.0d0/9.0d0)*(beta**2)+(1.0d0/9.0d0))
        fa(46)=(5.0*(alpha**4)-(15.0d0/4.0d0)*(alpha**2)+0.25)*((beta**3)-beta)
        fa(47)=(6.0*(alpha**5)-(28.0/5.0)*(alpha**3)+(518.0d0/625.0d0)*alpha)*((beta**2)-1.0d0)
          
        fb(39)=-0.5d0*((alpha**8)-(12.0d0/7.0d0)*(alpha**6)+(282.0d0/343.0d0)*(alpha**4)-(12916.0d0/117649.0d0)*(alpha**2)+(225.0d0/117649.0d0))
        fb(40)=0.5d0*(1.0d0+alpha)*(8.0*(beta**7)-(72.0d0/7.0d0)*(beta**5)+(1128.0d0/343.0d0)*(beta**3)-(25832.0d0/117649.0d0)*(beta))
        fb(41)=0.5d0*((alpha**8)-(12.0d0/7.0d0)*(alpha**6)+(282.0d0/343.0d0)*(alpha**4)-(12916.0d0/117649.0d0)*(alpha**2)+(225.0d0/117649.0d0))
        fb(42)=0.5d0*(1.0d0-alpha)*(8.0*(beta**7)-(72.0d0/7.0d0)*(beta**5)+(1128.0d0/343.0d0)*(beta**3)-(25832.0d0/117649.0d0)*(beta))
        fb(43)=((alpha**2)-1.0d0)*(6.0*(beta**5)-(28.0d0/5.0d0)*(beta**3)+(518.0d0/625.0d0)*beta)
        fb(44)=((alpha**3)-alpha)*(5.0*(beta**4)-(15.0/4.0)*(beta**2)+0.25)
        fb(45)=((alpha**4)-(10.0d0/9.0d0)*(alpha**2)+(1.0d0/9.0d0))*(4.0*(beta**3)-(20.0/9.0)*beta)
        fb(46)=((alpha**5)-(5.0d0/4.0d0)*(alpha**3)+0.25*alpha)*(3.0*(beta**2)-1.0d0)
        fb(47)=((alpha**6)-(7.0d0/5.0d0)*(alpha**4)+(259.0d0/625.0d0)*(alpha**2)-(9.0d0/625.0d0))*(2.0*beta)
          
        if (mexp.eq.47) then
            GOTO 2005
        endif
    !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!  
          
        f(48)=0.5d0*(1.0d0-beta)*((alpha**9)-(15.0d0/8.0d0)*(alpha**7)+(273.0d0/256.0d0)*(alpha**5)-(205.0d0/1024.0d0)*(alpha**3)+(9.0d0/1024.0d0)*alpha)
        f(49)=0.5d0*(1.0d0+alpha)*((beta**9)-(15.0d0/8.0d0)*(beta**7)+(273.0d0/256.0d0)*(beta**5)-(205.0d0/1024.0d0)*(beta**3)+(9.0d0/1024.0d0)*beta)
        f(50)=0.5d0*(1.0d0+beta)*(-1.0d0*(alpha**9)+(15.0d0/8.0d0)*(alpha**7)-(273.0d0/256.0d0)*(alpha**5)+(205.0d0/1024.0d0)*(alpha**3)-(9.0d0/1024.0d0)*alpha)
        f(51)=0.5d0*(1.0d0-alpha)*(-1.0d0*(beta**9)+(15.0d0/8.0d0)*(beta**7)-(273.0d0/256.0d0)*(beta**5)+(205.0d0/1024.0d0)*(beta**3)-(9.0d0/1024.0d0)*beta)
        f(52)=((alpha**2)-1.0d0)*((beta**7)-(14.0d0/9.0d0)*(beta**5)+(49.0d0/81.0d0)*(beta**3)-(4.0d0/81.0d0)*beta)
        f(53)=((alpha**3)-alpha)*((beta**6)-(7.0d0/5.0d0)*(beta**4)+(259.0d0/625.0d0)*(beta**2)-(9.0d0/625.0d0))
        f(54)=((alpha**4)-(10.0d0/9.0d0)*(alpha**2)+(1.0d0/9.0d0))*((beta**5)-(5.0d0/4.0d0)*(beta**3)+(1.0d0/4.0d0)*beta)
        f(55)=((alpha**5)-(5.0d0/4.0d0)*(alpha**3)+0.25*alpha)*((beta**4)-(10.0d0/9.0d0)*(beta**2)+(1.0d0/9.0d0))
        f(56)=((alpha**6)-(7.0d0/5.0d0)*(alpha**4)+(259.0d0/625.0d0)*(alpha**2)-(9.0d0/625.0d0))*((beta**3)-beta)
        f(57)=((alpha**7)-(14.0d0/9.0d0)*(alpha**5)+(49.0d0/81.0d0)*(alpha**3)-(4.0d0/81.0d0)*alpha)*((beta**2)-1.0d0)
          
        fa(48)=0.5d0*(1.0d0-beta)*(9.0d0*(alpha**8)-(105.0d0/8.0d0)*(alpha**6)+(1365.0d0/256.0d0)*(alpha**4)-(615.0d0/1024.0d0)*(alpha**2)+(9.0d0/1024.0d0))
        fa(49)=0.5d0*((beta**9)-(15.0d0/8.0d0)*(beta**7)+(273.0d0/256.0d0)*(beta**5)-(205.0d0/1024.0d0)*(beta**3)+(9.0d0/1024.0d0)*beta)
        fa(50)=0.5d0*(1.0d0+beta)*(-9.0d0*(alpha**8)+(105.0d0/8.0d0)*(alpha**6)-(1365.0d0/256.0d0)*(alpha**4)+(615.0d0/1024.0d0)*(alpha**2)-(9.0d0/1024.0d0))
        fa(51)=-0.5d0*(-1.0d0*(beta**9)+(15.0d0/8.0d0)*(beta**7)-(273.0d0/256.0d0)*(beta**5)+(205.0d0/1024.0d0)*(beta**3)-(9.0d0/1024.0d0)*beta)
        fa(52)=(2.0*alpha)*((beta**7)-(14.0d0/9.0d0)*(beta**5)+(49.0d0/81.0d0)*(beta**3)-(4.0d0/81.0d0)*beta)
        fa(53)=(3.0*(alpha**2)-1.0d0)*((beta**6)-(7.0d0/5.0d0)*(beta**4)+(259.0d0/625.0d0)*(beta**2)-(9.0d0/625.0d0))
        fa(54)=(4.0*(alpha**3)-(20.0d0/9.0d0)*alpha)*((beta**5)-(5.0d0/4.0d0)*(beta**3)+(1.0d0/4.0d0)*beta)
        fa(55)=(5.0*(alpha**4)-(15.0d0/4.0d0)*(alpha**2)+0.25)*((beta**4)-(10.0d0/9.0d0)*(beta**2)+(1.0d0/9.0d0))
        fa(56)=(6.0*(alpha**5)-(28.0/5.0)*(alpha**3)+(518.0d0/625.0d0)*alpha)*((beta**3)-beta)
        fa(57)=(7.0*(alpha**6)-(70.0d0/9.0d0)*(alpha**4)+(147.0d0/81.0d0)*(alpha**2)-(4.0d0/81.0d0))*((beta**2)-1.0d0)
          
        fb(48)=-0.5d0*((alpha**9)-(15.0d0/8.0d0)*(alpha**7)+(273.0d0/256.0d0)*(alpha**5)-(205.0d0/1024.0d0)*(alpha**3)+(9.0d0/1024.0d0)*alpha)
        fb(49)=0.5d0*(1.0d0+alpha)*(9.0d0*(beta**8)-(105.0d0/8.0d0)*(beta**6)+(1365.0d0/256.0d0)*(beta**4)-(615.0d0/1024.0d0)*(beta**2)+(9.0d0/1024.0d0))
        fb(50)=0.5d0*(-1.0d0*(alpha**9)+(15.0d0/8.0d0)*(alpha**7)-(273.0d0/256.0d0)*(alpha**5)+(205.0d0/1024.0d0)*(alpha**3)-(9.0d0/1024.0d0)*alpha)
        fb(51)=0.5d0*(1.0d0-alpha)*(-9.0d0*(beta**8)+(105.0d0/8.0d0)*(beta**6)-(1365.0d0/256.0d0)*(beta**4)+(615.0d0/1024.0d0)*(beta**2)-(9.0d0/1024.0d0))
        fb(52)=((alpha**2)-1.0d0)*(7.0*(beta**6)-(70.0d0/9.0d0)*(beta**4)+(147.0d0/81.0d0)*(beta**2)-(4.0d0/81.0d0)) 
        fb(53)=((alpha**3)-alpha)*(6.0*(beta**5)-(28.0d0/5.0d0)*(beta**3)+(518.0d0/625.0d0)*beta)
        fb(54)=((alpha**4)-(10.0d0/9.0d0)*(alpha**2)+(1.0d0/9.0d0))*(5.0*(beta**4)-(15.0/4.0)*(beta**2)+0.25)
        fb(55)=((alpha**5)-(5.0d0/4.0d0)*(alpha**3)+0.25*alpha)*(4.0*(beta**3)-(20.0/9.0)*beta)
        fb(56)=((alpha**6)-(7.0d0/5.0d0)*(alpha**4)+(259.0d0/625.0d0)*(alpha**2)-(9.0d0/625.0d0))*(3.0*(beta**2)-1.0d0)
        fb(57)=((alpha**7)-(14.0d0/9.0d0)*(alpha**5)+(49.0d0/81.0d0)*(alpha**3)-(4.0d0/81.0d0)*alpha)*(2.0d0*beta)
          
        if (mexp.eq.57) then
            GOTO 2005
        endif
    !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! 
          
        f(58)=0.5*(1.0d0-beta)*((alpha**10)-(55.0d0/27.0d0)*(alpha**8)+(2926.0d0/2187.0d0)*(alpha**6)-(172810.0d0/531441.0d0)*(alpha**4)+(117469.0d0/4782969.0d0)*(alpha**2)-(1225.0d0/4782969.0d0))
        f(59)=0.5*(1.0d0+alpha)*((beta**10)-(55.0d0/27.0d0)*(beta**8)+(2926.0d0/2187.0d0)*(beta**6)-(172810.0d0/531441.0d0)*(beta**4)+(117469.0d0/4782969.0d0)*(beta**2)-(1225.0d0/4782969.0d0))
        f(60)=0.5*(1.0d0+beta)*((alpha**10)-(55.0d0/27.0d0)*(alpha**8)+(2926.0d0/2187.0d0)*(alpha**6)-(172810.0d0/531441.0d0)*(alpha**4)+(117469.0d0/4782969.0d0)*(alpha**2)-(1225.0d0/4782969.0d0))
        f(61)=0.5*(1.0d0-alpha)*((beta**10)-(55.0d0/27.0d0)*(beta**8)+(2926.0d0/2187.0d0)*(beta**6)-(172810.0d0/531441.0d0)*(beta**4)+(117469.0d0/4782969.0d0)*(beta**2)-(1225.0d0/4782969.0d0))
        f(62)=((alpha**2)-1.0d0)*((beta**8)-(12.0d0/7.0d0)*(beta**6)+(282.0d0/343.0d0)*(beta**4)-(12916.0d0/117649.0d0)*(beta**2)+(225.0d0/117649.0d0))
        f(63)=((alpha**3)-alpha)*((beta**7)-(14.0d0/9.0d0)*(beta**5)+(49.0d0/81.0d0)*(beta**3)-(4.0d0/81.0d0)*beta)
        f(64)=((alpha**4)-(10.0d0/9.0d0)*(alpha**2)+(1.0d0/9.0d0))*((beta**6)-(7.0d0/5.0d0)*(beta**4)+(259.0d0/625.0d0)*(beta**2)-(9.0d0/625.0d0))
        f(65)=((alpha**5)-(5.0d0/4.0d0)*(alpha**3)+0.25*alpha)*((beta**5)-(5.0d0/4.0d0)*(beta**3)+(1.0d0/4.0d0)*beta)
        f(66)=((alpha**6)-(7.0d0/5.0d0)*(alpha**4)+(259.0d0/625.0d0)*(alpha**2)-(9.0d0/625.0d0))*((beta**4)-(10.0d0/9.0d0)*(beta**2)+(1.0d0/9.0d0))
        f(67)=((alpha**7)-(14.0d0/9.0d0)*(alpha**5)+(49.0d0/81.0d0)*(alpha**3)-(4.0d0/81.0d0)*alpha)*((beta**3)-beta)
        f(68)=((alpha**8)-(12.0d0/7.0d0)*(alpha**6)+(282.0d0/343.0d0)*(alpha**4)-(12916.0d0/117649.0d0)*(alpha**2)+(225.0d0/117649.0d0))*((beta**2)-1.0d0)
          
        fa(58)=0.5*(1.0d0-beta)*(10.0d0*(alpha**9)-(440.0d0/27.0d0)*(alpha**7)+(5825.0d0/729.0d0)*(alpha**5)-(691240.0d0/531441.0d0)*(alpha**3)+(234938.0d0/4782969.0d0)*alpha)
        fa(59)=0.5*((beta**10)-(55.0d0/27.0d0)*(beta**8)+(2926.0d0/2187.0d0)*(beta**6)-(172810.0d0/531441.0d0)*(beta**4)+(117469.0d0/4782969.0d0)*(beta**2)-(1225.0d0/4782969.0d0))
        fa(60)=0.5*(1.0d0+beta)*(10.0d0*(alpha**9)-(440.0d0/27.0d0)*(alpha**7)+(5825.0d0/729.0d0)*(alpha**5)-(691240.0d0/531441.0d0)*(alpha**3)+(234938.0d0/4782969.0d0)*alpha)
        fa(61)=-0.5*((beta**10)-(55.0d0/27.0d0)*(beta**8)+(2926.0d0/2187.0d0)*(beta**6)-(172810.0d0/531441.0d0)*(beta**4)+(117469.0d0/4782969.0d0)*(beta**2)-(1225.0d0/4782969.0d0))
        fa(62)=(2.0*alpha)*((beta**8)-(12.0d0/7.0d0)*(beta**6)+(282.0d0/343.0d0)*(beta**4)-(12916.0d0/117649.0d0)*(beta**2)+(225.0d0/117649.0d0))
        fa(63)=(3.0*(alpha**2)-1.0d0)*((beta**7)-(14.0d0/9.0d0)*(beta**5)+(49.0d0/81.0d0)*(beta**3)-(4.0d0/81.0d0)*beta)
        fa(64)=(4.0*(alpha**3)-(20.0d0/9.0d0)*alpha)*((beta**6)-(7.0d0/5.0d0)*(beta**4)+(259.0d0/625.0d0)*(beta**2)-(9.0d0/625.0d0))
        fa(65)=(5.0*(alpha**4)-(15.0d0/4.0d0)*(alpha**2)+0.25)*((beta**5)-(5.0d0/4.0d0)*(beta**3)+(1.0d0/4.0d0)*beta)
        fa(66)=(6.0*(alpha**5)-(28.0/5.0)*(alpha**3)+(518.0d0/625.0d0)*alpha)*((beta**4)-(10.0d0/9.0d0)*(beta**2)+(1.0d0/9.0d0))
        fa(67)=(7.0*(alpha**6)-(70.0d0/9.0d0)*(alpha**4)+(147.0d0/81.0d0)*(alpha**2)-(4.0d0/81.0d0))*((beta**3)-beta)
        fa(68)=(8.0d0*(alpha**7)-(72.0d0/7.0d0)*(alpha**5)+(1128.0d0/343.0d0)*(alpha**3)-(25832.0d0/117649.0d0)*(alpha))*((beta**2)-1.0d0)
          
        fb(58)=-0.5*((alpha**10)-(55.0d0/27.0d0)*(alpha**8)+(2926.0d0/2187.0d0)*(alpha**6)-(172810.0d0/531441.0d0)*(alpha**4)+(117469.0d0/4782969.0d0)*(alpha**2)-(1225.0d0/4782969.0d0))
        fb(59)=0.5*(1.0d0+alpha)*(10.0d0*(beta**9)-(440.0d0/27.0d0)*(beta**7)+(5825.0d0/729.0d0)*(beta**5)-(691240.0d0/531441.0d0)*(beta**3)+(234938.0d0/4782969.0d0)*beta)
        fb(60)=0.5*((alpha**10)-(55.0d0/27.0d0)*(alpha**8)+(2926.0d0/2187.0d0)*(alpha**6)-(172810.0d0/531441.0d0)*(alpha**4)+(117469.0d0/4782969.0d0)*(alpha**2)-(1225.0d0/4782969.0d0))
        fb(61)=0.5*(1.0d0-alpha)*(10.0d0*(beta**9)-(440.0d0/27.0d0)*(beta**7)+(5825.0d0/729.0d0)*(beta**5)-(691240.0d0/531441.0d0)*(beta**3)+(234938.0d0/4782969.0d0)*beta)
        fb(62)=((alpha**2)-1.0d0)*(8.0*(beta**7)-(72.0d0/7.0d0)*(beta**5)+(1128.0d0/343.0d0)*(beta**3)-(25832.0d0/117649.0d0)*(beta))
        fb(63)=((alpha**3)-alpha)*(7.0*(beta**6)-(70.0d0/9.0d0)*(beta**4)+(147.0d0/81.0d0)*(beta**2)-(4.0d0/81.0d0)) 
        fb(64)=((alpha**4)-(10.0d0/9.0d0)*(alpha**2)+(1.0d0/9.0d0))*(6.0*(beta**5)-(28.0d0/5.0d0)*(beta**3)+(518.0d0/625.0d0)*beta)
        fb(65)=((alpha**5)-(5.0d0/4.0d0)*(alpha**3)+0.25*alpha)*(5.0*(beta**4)-(15.0/4.0)*(beta**2)+0.25)
        fb(66)=((alpha**6)-(7.0d0/5.0d0)*(alpha**4)+(259.0d0/625.0d0)*(alpha**2)-(9.0d0/625.0d0))*(4.0*(beta**3)-(20.0/9.0)*beta)
        fb(67)=((alpha**7)-(14.0d0/9.0d0)*(alpha**5)+(49.0d0/81.0d0)*(alpha**3)-(4.0d0/81.0d0)*alpha)*(3.0*(beta**2)-1.0d0)
        fb(68)=((alpha**8)-(12.0d0/7.0d0)*(alpha**6)+(282.0d0/343.0d0)*(alpha**4)-(12916.0d0/117649.0d0)*(alpha**2)+(225.0d0/117649.0d0))*(2.0*beta)
        if (mexp.eq.68) then
            GOTO 2005
        endif    
    endif
        
    !xa=fa(1)*cscord(elemcon(ele,2,cs),2,cs)+fa(2)*cscord(elemcon(ele,3,cs),2,cs)+fa(3)*cscord(elemcon(ele,4,cs),2,cs)+fa(4)*cscord(elemcon(ele,5,cs),2,cs)
    !xb=fb(1)*cscord(elemcon(ele,2,cs),2,cs)+fb(2)*cscord(elemcon(ele,3,cs),2,cs)+fb(3)*cscord(elemcon(ele,4,cs),2,cs)+fb(4)*cscord(elemcon(ele,5,cs),2,cs)
    !za=fa(1)*cscord(elemcon(ele,2,cs),3,cs)+fa(2)*cscord(elemcon(ele,3,cs),3,cs)+fa(3)*cscord(elemcon(ele,4,cs),3,cs)+fa(4)*cscord(elemcon(ele,5,cs),3,cs)
    !zb=fb(1)*cscord(elemcon(ele,2,cs),3,cs)+fb(2)*cscord(elemcon(ele,3,cs),3,cs)+fb(3)*cscord(elemcon(ele,4,cs),3,cs)+fb(4)*cscord(elemcon(ele,5,cs),3,cs)
    !jacob(elbm)=(y((nne-1)*elbm+1)-y((nne-1)*(elbm-1)+1))/2.0d0
    !yeta=(y((nne-1)*elbm+1)-y((nne-1)*(elbm-1)+1))/2.0d0    
    !jac3D(1,1)=xa; jac3D(1,2)=ya; jac3D(1,3)=za
    !jac3D(2,1)=xeta; jac3D(2,2)=yeta; jac3D(2,3)=zeta
    !jac3D(3,1)=xb; jac3D(3,2)=yb; jac3D(3,3)=zb
    !det_jac_3D=(jac3D(1,1)*(jac3D(2,2)*jac3D(3,3)-jac3D(2,3)*jac3D(3,2))-jac3D(1,2)*(jac3D(2,1)*jac3D(3,3)-jac3D(2,3)*jac3D(3,1))+jac3D(1,3)*(jac3D(2,1)*jac3D(3,2)-jac3D(2,2)*jac3D(3,1))) 
    !call matinv3(jac3D,jac3D_inv)
    
2005	return
        end subroutine
    
end module
